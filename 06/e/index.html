<!DOCTYPE html>
<html>

<head>
   <meta charset="utf-8">
   <title>Detecção de colisões</title>
   <script src="js/animacao.js"></script>
    <script src="js/teclado.js"></script>
    <script src="js/nave.js"></script>
    <script src="js/tiro.js"></script>
    <script src="js/fundo.js"></script>
    <script src="js/colisor.js"></script>
    <script src="js/ovni.js"></script>
   <style type="text/css">
        canvas{
            border: solid 1px black;
        }
   </style>
</head>

<body>
   <canvas id="my_canvas" width="500" height="500"></canvas>
   <script>
      
       var canvas = document.getElementById('my_canvas');
       var context = canvas.getContext('2d');

       var animacao = new Animacao(context);
       var teclado = new Teclado(document);
       var colisor = new Colisor();
       
       var carregadas = 0;
       var totalImagens = 5;

       var imgOvni = new Image();
       var imgNave = new Image();
       var imgEspaco = new Image();
       var imgEstrelas = new Image();
       var imgNuvens = new Image();
       

       imgNave.src = "img/nave.png";
       imgOvni.src = "img/ovni.png";
       
       imgEspaco.src = "img/fundo-espaco.png";
       imgEstrelas.src = "img/fundo-estrelas.png";
       imgNuvens.src = "img/fundo-nuvens.png";
       
       
       var nave = new Nave(context,teclado,imgNave);
       
       teclado.disparou(ESPACO,function(){
            nave.atirar();
       });
       
       imgNave.onload = carregando;
       imgOvni.onload = carregando;
       imgEspaco.onload = carregando;
       imgEstrelas.onload = carregando;
       imgNuvens.onload = carregando;
       
       function carregando(){
            carregadas++;
           if (carregadas == totalImagens){
            iniciar();
           }
       }
       
       function iniciar(){
           var fundoEspaco = new Fundo(context,imgEspaco);
           var fundoEstrelas = new Fundo(context,imgEstrelas);
           var fundoNuvens = new Fundo(context,imgNuvens);
           
           fundoEspaco.velocidade = 3;
           fundoEstrelas.velocidade = 7;
           fundoNuvens.velocidade = 10;
           
           animacao.novoSprite(fundoEspaco);
           animacao.novoSprite(fundoEstrelas);
           animacao.novoSprite(fundoNuvens);           
           
           nave.x = canvas.width / 2 - imgNave.width / 2;
           nave.y = canvas.height - imgNave.height;
           nave.velocidade = 5;
                      
           animacao.novoSprite(nave);
           
           colisor.novoSprite(nave);
           
           animacao.novoProcessamento(colisor);
           
           animacao.ligar();
           
           setInterval(novoOvni,2000);
       }
       
       function novoOvni(){
           var ovni = new Ovni(context,imgOvni);
           
           ovni.velocidade = aleatorio(5,10);
           ovni.x = aleatorio(0,canvas.width - imgOvni.width);
           ovni.y -= imgOvni.height;
           
           animacao.novoSprite(ovni);
           colisor.novoSprite(ovni);
           
       }
       
       function aleatorio(min, max){
            return min + Math.floor(Math.random() * (max - min +1));
       }
       
       
   </script>
</body>

</html>
